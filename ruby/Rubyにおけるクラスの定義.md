## Rubyにおけるクラスの定義
Ruby のクラスを定義する構文
```rb
class クラス名
end
```
クラス名は必ず大文字で始める。慣習としてクラス名はアッパーキャメルケースで表す。

### new / initialize
クラスからオブジェクトを作成する場合は [[new]] メソッドを使う。
このときに [[initialize]] メソッドが呼ばれるので、インスタンス初期化時に実行したい処理をこのメソッド内に書く。

[[initialize]] メソッドはデフォルトで [[private]] メソッドになっている。

[[initialize]] メソッドに引数をつけると、[[new]] メソッドにも引数が必要になる。

### インスタンスメソッド
クラス構文内でメソッドを定義すると、そのメソッドは[[インスタンスメソッド]] (そのクラスのインスタンスを[[レシーバ]]として呼び出せるメソッド) になる。
```rb
class User
  def hello
    "Hello"
  end
end

user = User.new
user.hello #=> Hello
```

### インスタンス変数
クラス内では[[インスタンス変数]] (同じインスタンス (オブジェクト) 内で共有される変数) を使うことができる。
Ruby では `@` で始まる変数がインスタンス変数を表す (他に `@@` で始まる[[クラス変数]]、`$` で始まる[[グローバル変数]]がある)。
```rb
class User
  def initialize(name)
    @name = name
  end
  def hello
    "Hello, #{@name}"
  end
end
```

[[ローカル変数]] (作成時にプレフィックスがつかない変数) が作成前の参照時にエラーを返すのに対し、[[インスタンス変数]]はエラーを発生させず nil を返す。

#### インスタンス変数の参照、変更
[[インスタンス変数]]をクラスの外部から参照したいときは参照用のメソッドを作る必要がある。これを[[セッター]] (setter) メソッドと呼ぶ。
```rb
def name
  @name
end
```
同様に、インスタンス変数を外部から変更したいときも専用のメソッドを作る必要がある。これを[[ゲッター]] (getter) メソッドと呼ぶ。
```rb
def name=(value)
  @name = value
end
```

セッターメソッドとゲッターメソッドを総称して[[アクセサ]] (accessor) メソッドと呼ぶ。[[attr_accessor]] でセッター&ゲッターメソッドを定義できる。
なお読み取り専用にしたい場合は [[attr_reader]]、書き込み専用にしたい場合は [[attr_writer]] を使う。
```rb
# 前述の name メソッドや name= メソッドの定義を省略可能
# カンマ区切りで複数定義可能
attr_accessor :name, :age
```

### クラスメソッド
クラス内で単純にメソッドを定義すると前述の通り[インスタンスメソッド](#インスタンスメソッド)になる。

これに対し、以下の方法で定義できるメソッドを[[クラスメソッド]]と呼ぶ。主に個々のインスタンスに含まれるデータを扱わないメソッドを定義したいときに使われる。
クラスメソッドを呼び出す際は、`クラス名.メソッド名` のようにする。

```rb
# クラスメソッド定義方法その1 … メソッド名に self. をつける
def self.class_method1
  # 処理
end

# クラスメソッド定義方法その2 … class << self .. end 内にメソッドを書く
class << self
  def class_method2
    # 処理
  end
end
```

[[クラスメソッド]]は、厳密に言うと「クラスオブジェクトの[[特異メソッド]]」を定義していることになる。

### 定数
クラス内で[[定数]]を定義できる。定数は大文字で始める必要があり、慣習的に「アルファベット大文字」「数字」「アンダースコア」で構成される。


source: [[『プロを目指す人のためのRuby入門［改訂2版］』]]
